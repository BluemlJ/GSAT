package analysis;

import java.util.LinkedList;

/**
 * Models a sequence under analysis (i.e. obtained from an AB1 file).
 * 
 */
public class AnalyzedSequence extends Sequence {

    /**
     * The gene this sequence was formed from. Useful to compare the sequence with the gene.
     */
    private Gene referencedGene;
    
    /**
     * Information to be stored in the database together
     * with the sequence (indicates how the sequence was obtained).
     */
    private String primer;
    
    
    /**
     * A list of discovered mutations to be stored.
     */
    private LinkedList<String> mutations;
    
    
    
    /**
     * A list of discovered silent mutations to be stored
     */
    private LinkedList<String> silentMutations;
    
    
    /**
     * The point in the data sequence from which on the sequence itself is 
     * considered unreliable. This number is zero-based (index in String).
     */
    private int endOfTrustworthyness;
    
    
    
    /**
     * Constructor calling the super constructor (which sets the only given attribute).
     * 
     * @param sequence The actual sequence of nucleotides as a String.
     */
    public AnalyzedSequence(String sequence) {
	super(sequence);
    }
    
    /**
     * Add a discovered (normal) mutation.
     */
    public void addMutation(String mutation) {
	mutations.add(mutation);
    }
    
    /**
     * Adds a discovered silent mutation.
     */
    public void addSilentMutation(String mutation) {
	silentMutations.add(mutation);
    }
    
    
    /**
     * Sets the point of the data starting to be unreliable.
     */
    public void setEndOfThrustworthyness(int endPoint) {
	endOfTrustworthyness = endPoint;
    }
    
    
    /**
     * Updates the sequence (e.g. after trimming off the ends).
     */
    public void updateSequence(String seq) {
	sequence = seq;
    }
    
    
    
    
}
